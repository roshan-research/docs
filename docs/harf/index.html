
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="description"
            content="Documentation for the حرف API"
        >
    <title>API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #303030;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sa {
  color: #aa759f;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-1086c5ef.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-9801298e.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-b49a9d77.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;plaintext&quot;,&quot;python&quot;]">
  <div style="position:fixed;z-index:50;height:4px;width:100%;background-color:#FF6200;">
  </div>
    <div class="toc-wrapper">
      <div>
        <a href="#" id="nav-button">
          <span>
            <img src="images/navbar-cad8cdcb.png" alt="" />
            <span>منو</span> 
          </span>
        </a>
        <div>
          <img src="images/logo-639416b0.svg" class="logo" alt="" />
            <div class="search">
              <input type="text" class="search" id="input-search" placeholder="جست و جو">
            </div>
            <ul class="search-results"></ul>
          <ul id="toc" class="toc-list-h1">
              <li>
                <a href="#92f5faa2a5" class="toc-h1 toc-link" data-title="حرف">حرف</a>
              </li>
              <li>
                <a href="#c15d6ded38" class="toc-h1 toc-link" data-title="تبدیل صدا به متن">تبدیل صدا به متن</a>
                  <ul class="toc-list-h2">
                      <li>
                        <a href="#3d73ced6bf" class="toc-h2 toc-link" data-title="مثال: ارسال آدرس فایل‌ها">مثال: ارسال آدرس فایل‌ها</a>
                      </li>
                      <li>
                        <a href="#81be89ebee" class="toc-h2 toc-link" data-title="مثال: آپلود فایل">مثال: آپلود فایل</a>
                      </li>
                      <li>
                        <a href="#02daeb1f13" class="toc-h2 toc-link" data-title="مثال: بررسی وضعیت پردازش">مثال: بررسی وضعیت پردازش</a>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="#b63b6bb6e5" class="toc-h1 toc-link" data-title="هم ترازی متن و گفتار">هم ترازی متن و گفتار</a>
                  <ul class="toc-list-h2">
                      <li>
                        <a href="#81be89ebee-2" class="toc-h2 toc-link" data-title="مثال: آپلود فایل">مثال: آپلود فایل</a>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="#3b1dd46314" class="toc-h1 toc-link" data-title="تبدیل پخش زندهٔ صدا به متن">تبدیل پخش زندهٔ صدا به متن</a>
                  <ul class="toc-list-h2">
                      <li>
                        <a href="#b40d4b44b2" class="toc-h2 toc-link" data-title="مثال">مثال</a>
                      </li>
                  </ul>
              </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='92f5faa2a5'>حرف</h1>
<p>حرف، یک ای‌پی‌آیِ بومی برای تبدیل گفتار به نوشتارِ فارسی است.</p>

<p>این ای‌پی‌آی با شنیدن هزاران ساعت گفتار در لحن‌ها، سبک‌ها، سرعت‌ها و رده‌های سنی مختلف، به‌خوبی آموزش دیده و با دقت بالایی می‌تواند <strong>صوت</strong>، <strong>ویدیو</strong> یا حتی <strong>پخش زنده</strong> را به متن فارسی تبدیل کند.</p>

<p>برای دسترسی به ای‌پی‌آی به یک <code>TOKEN_KEY</code> نیاز دارید که می‌توانید از طریق ایمیلِ <a href="mailto:harf@roshan-ai.ir">harf@roshan-ai.ir</a> درخواست دهید.</p>
<h1 id='c15d6ded38'>تبدیل صدا به متن</h1>
<p>این تابع، بسته‌ به تنظیم پارامترهای ورودی، می‌تواند کارهای مختلفی انجام می‌دهد که در ادامه برای هر یک مثالی آورده‌ایم.</p>

<p>بعد از تکمیل پردازش، پاسخی دریافت می‌کنید که حاوی آرایه‌ای از نتایج است. هر یک از عناصر این آرایه مربوط به نتایج یک فایل است.</p>

<p>در هر عنصر آرایه، آدرس فایل در پارامتر <code>media_url</code>، مدت‌زمان فایل در پارامتر <code>duration</code> و متن‌های استخراج‌شده در آرایهٔ <code>segments</code> قرار می‌گیرد.</p>

<p>هر سگمنت شامل سه پارامتر <code>start</code> زمان شروع بازه، <code>end</code> زمان پایان بازه و <code>text</code> متن بازه است. همچنین به ازای هر فایل، وضعیت شناسایی در پارامتر <code>stats</code> قرار می‌گیرد که خودش شامل دو زیرپارامتر است. اولی <code>words</code> است که حاوی کل تعداد کلمات فایل است و دومی <code>known_words</code> است که حاوی کلماتی است که بدون تردید تشخیص داده شده است.</p>

<p>حرف هرجایی که به تشخیص خود تردید می‌کند آن کلمه یا عبارت را درون قلاب (کروشه) می‌گذارد.</p>
<h2 id='3d73ced6bf'>مثال: ارسال آدرس فایل‌ها</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ]
}
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="nt">--request</span> POST <span class="se">\ </span>
      <span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span> <span class="se">\</span>
      <span class="nt">--data-binary</span> <span class="s1">'{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ]
}'</span> <span class="se">\</span>
      https://harf.roshan-ai.ir/api/transcribe_files/
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">try</span><span class="p">:</span>
   <span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">urlopen</span>
<span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
   <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span><span class="p">,</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">encodings</span> <span class="kn">import</span> <span class="n">utf_8</span>

<span class="n">values</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">"""
{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ]
}
"""</span>
<span class="p">,</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">'https://harf.roshan-ai.ir/api/transcribe_files/'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="n">response_body</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">utf_8</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response_body</span><span class="p">))</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"media_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://i.ganjoor.net/a2/41417.mp3"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:44"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"segments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[حکایت]"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"یکی را از حکما شنیدم که می گفت"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"هرگز کسی به جهل خویش اقرار نکرده است"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"مگر آن کس که چون دیگری در سخن باشد"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:21"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"همچنان ناتمام گفته سخن آغاز کند"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:21"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:26"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"سخن را سر از [ای] خردمند و بن"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:26"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:30"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"میا بر سخن در میان سخن"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:30"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:37"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"خداوند تدبیر و فرهنگ و [روش] نگوید سخن"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:37"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:39"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"تا نبیند خموش"</span><span class="w">
            </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
        </span><span class="nl">"stats"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"words"</span><span class="p">:</span><span class="w"> </span><span class="mi">57</span><span class="p">,</span><span class="w">
            </span><span class="nl">"known_words"</span><span class="p">:</span><span class="w"> </span><span class="mi">54</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">


</span></code></pre></div>
<p>روش اول برای تبدیل فایل‌های صوتی یا ویدیویی به متن، ارسال آدرس فایل‌ها در پارامتر <code>media_urls</code> است.</p>

<dl style="background-color:transparent;"><code>POST /api/transcribe_files/</code></dl>

<dl>
<strong>media_urls(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    List of URLs
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  آدرس فایل‌های صوتی یا ویدیویی یا ترکیبی از این دو</p>

<p><br><br>
<dl>
<strong>wait</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    true
                    </span>
</dl></p>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  اگر `true` باشد (مقدار پیش‌فرض)، تا پایان فرایند تبدیل فایل‌ها به متن باید منتظر بمانید اما اگر `false` باشد بلافاصله بعد از ارسال درخواست، پاسخی با ارسال وضعیت پردازش در پارامتر `state` و فهرستی از شناسه‌های پردازش در پارامتر `task_ids` (برای هر فایل یک شناسه) بازگردانده می‌شود که بعداً می‌توانید وضعیت پردازش این شناسه‌ها را جویا شوید.</p>

<p><br><br></p>
<h2 id='81be89ebee'>مثال: آپلود فایل</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>"    --{boundary value}\n    Content-Disposition: form-data; name='41417'; filename='FILE NAME'\n    Content-Type: audio/mpeg (according to the type of the uploaded file)\n    {file content}\n    --{boundary value}\n"
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span>
POST <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span>
<span class="nt">-F</span> <span class="s2">"media=@example.mp3"</span>
http://harf.roshan-ai.ir/api/transcribe_files/
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,}</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">'media'</span><span class="p">:</span> <span class="p">(</span><span class="s">'FILE NAME'</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">'YOUR FILE PATH'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)),}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://harf.roshan-ai.ir/api/transcribe_files//'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"media_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://i.ganjoor.net/a2/41417.mp3"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:44"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"segments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[حکایت]"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"یکی را از حکما شنیدم که می گفت"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"هرگز کسی به جهل خویش اقرار نکرده است"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"مگر آن کس که چون دیگری در سخن باشد"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:21"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"همچنان ناتمام گفته سخن آغاز کند"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:21"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:26"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"سخن را سر از [ای] خردمند و بن"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:26"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:30"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"میا بر سخن در میان سخن"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:30"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:37"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"خداوند تدبیر و فرهنگ و [روش] نگوید سخن"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:37"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:39"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"تا نبیند خموش"</span><span class="w">
            </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
        </span><span class="nl">"stats"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"words"</span><span class="p">:</span><span class="w"> </span><span class="mi">57</span><span class="p">,</span><span class="w">
            </span><span class="nl">"known_words"</span><span class="p">:</span><span class="w"> </span><span class="mi">54</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">


</span></code></pre></div>
<dl style="background-color:transparent;"><code>POST /api/transcribe_files/</code></dl>

<dl>
<strong>media(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    file in binary
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  فایل ورودی</p>

<p><br><br></p>
<h2 id='02daeb1f13'>مثال: بررسی وضعیت پردازش</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>{
    "media_urls": "List of URLs",
    "wait": true
}
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="nt">--request</span> POST <span class="se">\ </span>
      <span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span> <span class="se">\</span>
      <span class="nt">--data-binary</span> <span class="s1">'{
    "media_urls": "List of URLs",
    "wait": true
}'</span> <span class="se">\</span>
      https://harf.roshan-ai.ir/api/transcribe_files/
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">try</span><span class="p">:</span>
   <span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">urlopen</span>
<span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
   <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span><span class="p">,</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">encodings</span> <span class="kn">import</span> <span class="n">utf_8</span>

<span class="n">values</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">"""
{
    "media_urls": "List of URLs",
    "wait": true
}
"""</span>
<span class="p">,</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">'https://harf.roshan-ai.ir/api/transcribe_files/'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="n">response_body</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">utf_8</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response_body</span><span class="p">))</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="nl">"state"</span><span class="p">:</span><span class="s2">"PENDING"</span><span class="p">}</span><span class="w">


</span></code></pre></div>
<p>اگر در <a href="#c15d6ded38">تبدیل صدا به متن</a> ، درخواست خود را با پارامتر <code>wait=false</code> ارسال کرده باشید، فهرستی از شناسه‌های پردازش در پارامتر <code>task_ids</code> دریافت می‌کنید که برای بررسی وضعیت پردازش آن‌ها می‌توانید همانند مثال زیر عمل کنید.</p>

<p>در پاسخ، وضعیت پردازش در پارامتر <code>state</code> برگردانده می‌شود: <code>PENDING</code> یعنی در حال پردازش، <code>FAILURE</code> یعنی بروز خطا، <code>TIMEOUT</code> یعنی زمان پردازش فایل بیش از زمان تنظیم شده برای انتظار سامانه بوده و از دور پردازش خارج شده است.</p>

<dl style="background-color:transparent;"><code>POST /api/transcribe_files/</code></dl>

<dl>
<strong>media_urls(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    List of URLs
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  آدرس فایل‌های ورودی</p>

<p><br><br>
<dl>
<strong>wait</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    true
                    </span>
</dl></p>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  <a href="#c15d6ded38">توضیحات این پارامتر</a>، پیشتر آمده است.</p>

<p><br><br></p>
<h1 id='b63b6bb6e5'>هم ترازی متن و گفتار</h1>
<p>این تابع با دریافت یک فایل صوتی یا ویدیویی به همراه متنِ آن نشان می‌دهد که هر کلمه در کدام بخش از صدا ادا شده است. در پاسخ ارسالی <code>media_url</code>همان آدرس فایل ورودی است. <code>duration</code> طول فایل است و <code>segments</code> لیست کلماتِ موجود در پارامتر <code>text</code> است که زمان تشخیص شروع و پایان هر کدام از آن‌ها مشخص شده است. متن کلمه در پارامتر <code>text</code>، زمان شروع در پارامتر <code>start</code> و زمان پایان در پارمتر <code>end</code> قرار می‌گیرد.</p>
<h2 id='81be89ebee-2'>مثال: آپلود فایل</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>{
    "media_url": "https://i.ganjoor.net/a2/41417.mp3",
    "text": "حکایت یکی را از حکما شنیدم که می گفت: هرگز کسی به جهل خویش اقرار نکرده است، مگر آن کس که چون دیگری در سخن باشد همچنان  تمام ناگفته، سخن آغاز کند."
}
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="nt">--request</span> POST <span class="se">\ </span>
      <span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span> <span class="se">\</span>
      <span class="nt">--data-binary</span> <span class="s1">'{
    "media_url": "https://i.ganjoor.net/a2/41417.mp3",
    "text": "حکایت یکی را از حکما شنیدم که می گفت: هرگز کسی به جهل خویش اقرار نکرده است، مگر آن کس که چون دیگری در سخن باشد همچنان  تمام ناگفته، سخن آغاز کند."
}'</span> <span class="se">\</span>
      https://harf.roshan-ai.ir/api/alignment/
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">try</span><span class="p">:</span>
   <span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">urlopen</span>
<span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
   <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span><span class="p">,</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">encodings</span> <span class="kn">import</span> <span class="n">utf_8</span>

<span class="n">values</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">"""
{
    "media_url": "https://i.ganjoor.net/a2/41417.mp3",
    "text": "حکایت یکی را از حکما شنیدم که می گفت: هرگز کسی به جهل خویش اقرار نکرده است، مگر آن کس که چون دیگری در سخن باشد همچنان  تمام ناگفته، سخن آغاز کند."
}
"""</span>
<span class="p">,</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">'https://harf.roshan-ai.ir/api/alignment/'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="n">response_body</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">utf_8</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response_body</span><span class="p">))</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"media_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://i.ganjoor.net/a2/41417.mp3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"حکایت یکی را از حکما شنیدم که می گفت: هرگز کسی به جهل خویش اقرار نکرده است، مگر آن کس که چون دیگری در سخن باشد همچنان  تمام ناگفته، سخن آغاز کند."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"segments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:00.240000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:00.800000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"حکایت"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02.550000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02.830000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"یکی"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02.930000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:03.010000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"را"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:03.330000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:03.490000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"از"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:03.610000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:04.090000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"حکما"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:04.510000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:04.970000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"شنیدم"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:05.090000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:05.130000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"که"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:05.230000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:05.290000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"می"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:05.410000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:05.850000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"گفت:"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06.850000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:07.250000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"هرگز"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:07.410000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:07.770000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"کسی"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:08.110000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:08.170000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"به"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:08.370000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:08.670000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"جهل"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:08.890000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:09.250000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"خویش"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:09.430000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:09.950000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"اقرار"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:10.190000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:10.690000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"نکرده"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:10.770000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11.150000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"است،"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:12.040000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:12.360000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"مگر"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:12.580000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:12.740000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"آن"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:12.920000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:13.140000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"کس"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:13.300000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:13.360000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"که"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:13.520000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:13.680000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"چون"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:13.920000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:14.480000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"دیگری"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:14.620000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:14.720000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"در"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:14.860000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:15.180000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"سخن"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:15.340000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:15.840000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"باشد"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16.460000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:19.500000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"همچنان تمام ناگفته،"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:19.500000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:19.840000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"سخن"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:19.940000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:20.360000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"آغاز"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:20.500000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:20.780000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"کند."</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<dl style="background-color:transparent;"><code>POST /api/alignment/</code></dl>

<dl>
<strong>media_url(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    URL
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  آدرس فایل‌ ورودی</p>

<p><br><br>
<dl>
<strong>text(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    Text
                    </span>
</dl></p>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  متن فایل‌ ورودی.</p>

<p><br><br></p>
<h1 id='3b1dd46314'>تبدیل پخش زندهٔ صدا به متن</h1>
<p>برای تبدیل صدای درحال‌پخش (زنده، لایو، استریم) باید از طریق وب‌سوکت به سامانه متصل شوید. در این حالت، پس از برقراری ارتباط با سرور باید فایل خود را در قالب wav به‌شکل باینری ارسال کنید.</p>

<p><code>{&quot;segment_id&quot;: 1, &quot;text&quot;: &quot;سازمان بهداشت جهانی&quot;, &quot;start&quot;: &quot;0:00:00&quot;, &quot;end&quot;: &quot;0:00:05&quot;}</code></p>

<p>اگر پردازش کامل نشده باشد، پاسخی به‌شکل زیر دریافت می‌کنید:</p>

<p><code>{&quot;state&quot;: &quot;PENDING&quot;}</code></p>

<p>در انتها، برای اعلام پایان فرایند پردازش، باید متن <code>finalize</code> را به سرور ارسال کنید.</p>
<h2 id='b40d4b44b2'>مثال</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>from websocket import create_connection 

def make_socket_connection(url, header):
    socket = create_connection(url, header=header)
    return socket

def read_wave_file_as_binary(wave_file):
    with open(wave_file ,'rb') as f:
        binary=f.read()
        return binary

def convert_wave_to_text(binary, socket, window_size=32000):
    number_of_window = (len(binary) + 1) // window_size
    for i in range(number_of_window):
        socket.send_binary(binary[window_size*i:window_size*(i+1)])
        data = socket.recv()
    socket.send("finalize")
    data= socket.recv()
    socket.close()

def main():
    header = {'Authorization' : 'Token ...'}
    url = "wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"
    wave_file = "Your wave file path"
    binary = read_wave_file_as_binary(wave_file)
    socket = make_socket_connection(url, header)
    convert_wave_to_text(binary, socket)
main()

</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>from websocket import create_connection 

def make_socket_connection<span class="o">(</span>url, header<span class="o">)</span>:
    socket <span class="o">=</span> create_connection<span class="o">(</span>url, <span class="nv">header</span><span class="o">=</span>header<span class="o">)</span>
    <span class="k">return </span>socket

def read_wave_file_as_binary<span class="o">(</span>wave_file<span class="o">)</span>:
    with open<span class="o">(</span>wave_file ,<span class="s1">'rb'</span><span class="o">)</span> as f:
        <span class="nv">binary</span><span class="o">=</span>f.read<span class="o">()</span>
        <span class="k">return </span>binary

def convert_wave_to_text<span class="o">(</span>binary, socket, <span class="nv">window_size</span><span class="o">=</span>32000<span class="o">)</span>:
    number_of_window <span class="o">=</span> <span class="o">(</span>len<span class="o">(</span>binary<span class="o">)</span> + 1<span class="o">)</span> // window_size
    <span class="k">for </span>i <span class="k">in </span>range<span class="o">(</span>number_of_window<span class="o">)</span>:
        socket.send_binary<span class="o">(</span>binary[window_size<span class="k">*</span>i:window_size<span class="k">*</span><span class="o">(</span>i+1<span class="o">)])</span>
        data <span class="o">=</span> socket.recv<span class="o">()</span>
    socket.send<span class="o">(</span><span class="s2">"finalize"</span><span class="o">)</span>
    <span class="nv">data</span><span class="o">=</span> socket.recv<span class="o">()</span>
    socket.close<span class="o">()</span>

def main<span class="o">()</span>:
    header <span class="o">=</span> <span class="o">{</span><span class="s1">'Authorization'</span> : <span class="s1">'Token ...'</span><span class="o">}</span>
    url <span class="o">=</span> <span class="s2">"wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"</span>
    wave_file <span class="o">=</span> <span class="s2">"Your wave file path"</span>
    binary <span class="o">=</span> read_wave_file_as_binary<span class="o">(</span>wave_file<span class="o">)</span>
    socket <span class="o">=</span> make_socket_connection<span class="o">(</span>url, header<span class="o">)</span>
    convert_wave_to_text<span class="o">(</span>binary, socket<span class="o">)</span>
main<span class="o">()</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">websocket</span> <span class="kn">import</span> <span class="n">create_connection</span> 

<span class="k">def</span> <span class="nf">make_socket_connection</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
    <span class="n">socket</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">socket</span>

<span class="k">def</span> <span class="nf">read_wave_file_as_binary</span><span class="p">(</span><span class="n">wave_file</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">wave_file</span> <span class="p">,</span><span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">binary</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">binary</span>

<span class="k">def</span> <span class="nf">convert_wave_to_text</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">socket</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">32000</span><span class="p">):</span>
    <span class="n">number_of_window</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">window_size</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_window</span><span class="p">):</span>
        <span class="n">socket</span><span class="p">.</span><span class="n">send_binary</span><span class="p">(</span><span class="n">binary</span><span class="p">[</span><span class="n">window_size</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="n">window_size</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
    <span class="n">socket</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"finalize"</span><span class="p">)</span>
    <span class="n">data</span><span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
    <span class="n">socket</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span> <span class="p">:</span> <span class="s">'Token ...'</span><span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"</span>
    <span class="n">wave_file</span> <span class="o">=</span> <span class="s">"Your wave file path"</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="n">read_wave_file_as_binary</span><span class="p">(</span><span class="n">wave_file</span><span class="p">)</span>
    <span class="n">socket</span> <span class="o">=</span> <span class="n">make_socket_connection</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
    <span class="n">convert_wave_to_text</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span>
<span class="n">main</span><span class="p">()</span>

</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="nl">"state"</span><span class="p">:</span><span class="s2">"PENDING"</span><span class="p">}</span><span class="w">


</span></code></pre></div>
<dl style="background-color:transparent;"><code>POST /ws_api/transcribe_files/wav/sync/</code></dl>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">CURL</a>
                <a href="#" data-language-name="plaintext">RAW</a>
                <a href="#" data-language-name="python">PYTHON</a>
          </div>
      </div>
    </div>
  </body>
</html>

<script>
function Scroll(delay) {
    this.initialY = scrollY;
    this.callbacks = {
        start  : null,
        scroll : null,
        end    : null,
    };
    this.timeout = {
        delay  : delay || 150,
        handle : null,
    };
    this.handler = Scroll.handler.bind(this);
    window.addEventListener("scroll", this.handler);
}

Scroll.handler = function (e) {
    if (this.initialY == 0) {
        if (this.timeout.handle == null) {
            if (this.callbacks.start) {
                this.callbacks.start.call(this, e);
            }
        }
        if (this.timeout.handle !== null) {
            clearTimeout(this.timeout.handle);
        }
        if (this.callbacks.scroll) {
            this.callbacks.scroll.call(this, e);
        }
        var self = this;
        this.timeout.handle = setTimeout(function () {
            self.timeout.handle = null;
            if (self.callbacks.end) {
                self.callbacks.end.call(self, e);
            }
        }, this.timeout.delay);
    } else {
        this.initialY = 0;
    }
};

Scroll.prototype.addEventListener = function (event, callback) {
    if (Object.keys(this.callbacks).includes(event)) {
        this.callbacks[event] = callback;
    } else {
        console.warn("Invalid scroll event: " + event);
    }
};

window.addEventListener('DOMContentLoaded',() => {
    let tocLinks = document.getElementsByClassName('toc-link');
    
    for(let i = 0; i < tocLinks.length; i++) {
        tocLinks[i].addEventListener('click', () => {
            for(let i = 0; i < tocLinks.length; i++) {
                tocLinks[i].classList.add('toc-unstyled')
            }
        })
    }
    
    var sl = new Scroll(400);
    
    sl.addEventListener("end", function () {
        for(let i = 0; i < tocLinks.length; i++) {
            tocLinks[i].classList.remove('toc-unstyled')
        }
    });
});
</script>